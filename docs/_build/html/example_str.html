

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Stratified estimation of area of forest loss ○ &mdash; gee-assessment-tools 0.1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Two-stage Estimator ○" href="estimator_twostage.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> gee-assessment-tools
          

          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview ✓</a></li>
<li class="toctree-l1"><a class="reference internal" href="background.html">Theoretical background ✓</a></li>
<li class="toctree-l1"><a class="reference internal" href="definitions.html">Terminology ✓</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting started ✓</a></li>
</ul>
<p class="caption"><span class="caption-text">Sampling</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="sampling_srs.html">Simple Random Sampling ✓</a></li>
<li class="toctree-l1"><a class="reference internal" href="sampling_str.html">Stratified Random Sampling ✓</a></li>
<li class="toctree-l1"><a class="reference internal" href="sampling_sys.html">Simple Systematic Sampling ○</a></li>
<li class="toctree-l1"><a class="reference internal" href="sampling_str_sys.html">Stratified Systematic Sampling ○</a></li>
<li class="toctree-l1"><a class="reference internal" href="sampling_twostage.html">Two-stage Sampling ○</a></li>
</ul>
<p class="caption"><span class="caption-text">Interpretation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tsviewer.html">Time Series Viewer ○</a></li>
<li class="toctree-l1"><a class="reference internal" href="colearth.html">Collect Earth ○</a></li>
<li class="toctree-l1"><a class="reference internal" href="timesync.html">TimeSync ○</a></li>
</ul>
<p class="caption"><span class="caption-text">Analysis</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="estimator_guidance.html">Choosing an estimator ✓</a></li>
<li class="toctree-l1"><a class="reference internal" href="estimator_str.html">Stratified Estimator ○</a></li>
<li class="toctree-l1"><a class="reference internal" href="estimator_post_str.html">Post-stratified Estimator ○</a></li>
<li class="toctree-l1"><a class="reference internal" href="estimator_mod.html">Model-assisted Regression Estimator ○</a></li>
<li class="toctree-l1"><a class="reference internal" href="estimator_diff.html">Model-assisted Difference Estimator ○</a></li>
<li class="toctree-l1"><a class="reference internal" href="estimator_ratio.html">Model-assisted Ratio Estimator ○</a></li>
<li class="toctree-l1"><a class="reference internal" href="estimator_twostage.html">Two-stage Estimator ○</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Stratified estimation of area of forest loss ○</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#sampling-design">1. Sampling Design</a></li>
<li class="toctree-l2"><a class="reference internal" href="#response-design">2. Response Design</a></li>
<li class="toctree-l2"><a class="reference internal" href="#analysis">3. Analysis</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">gee-assessment-tools</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Stratified estimation of area of forest loss ○</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/example_str.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="stratified-estimation-of-area-of-forest-loss-cir">
<h1>Stratified estimation of area of forest loss ○<a class="headerlink" href="#stratified-estimation-of-area-of-forest-loss-cir" title="Permalink to this headline">¶</a></h1>
<p>An example is provided here to illustrate the estimation of the area of forest loss for the country of Cambodia between 2000 and 2010 using stratified estimation. The example has three different parts: 1) sampling design – a sample is selected by stratified random sampling; 2) response design which involves observing the reference conditions at sample unit in  various satellite data available in Google Earth Engine; and 3) the analysis which is based on the application of a stratified estimator to the sample data.</p>
<p><strong>Note that the sample data are made-up and do not reflect actual conditions in Cambodia!</strong></p>
<div class="section" id="sampling-design">
<h2>1. Sampling Design<a class="headerlink" href="#sampling-design" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li><strong>Stratification.</strong> Because the area of forest loss is small relative the total study area, using non-stratified designs would require a very large sample size to ensure a sufficient number of observations of forest loss in the sample data. To use a stratified design, we will first need to define a stratification. In this case, we will extract a map of Cambodia from a global map <a class="footnote-reference" href="#id5" id="id1">[1]</a> of (1) forest, (2) non-forest, (3) water, (4) forest loss, (5) forest gain, and (6) forest loss and gain. The map will serve a stratification of study area. Preferably, use the GeoTIFF format. (A tutorial from BEEODA illustrating the creation of a local stratification from the global map is provided <a class="reference external" href="https://github.com/beeoda/tutorials/tree/master/Use_of_global_tree_cover_and_change_datasets">here</a>)</li>
<li>You can download the stratification of Cambodia <a class="reference external" href="https://drive.google.com/open?id=1XYzslxY0F7X0Dum58-4_KTEBGqm2EEe3">here</a>. Once downloaded to your local computer, click the <em>Assets</em> tab next to the <em>Scripts</em> tab and <em>NEW</em> &gt; <em>Image upload</em> &gt; <em>SELECT</em>; click <em>Advanced</em> &gt; <em>Masking mode</em> &gt; and set <em>No-data value</em> to “0”. Click <em>OK</em> to upload the stratification as an image file. You can check the progress in the <em>Tasks</em> tab (the upload will take several minutes).</li>
<li>Once the stratification has been added to <em>Assets</em>, highlight the script “1_sampling_design” in the <em>Scripts</em> tab and click <em>Run</em>. (Check <a class="reference external" href="https://gee-assessment-tools.readthedocs.io/en/latest/overview.html">Overview</a> to familiarize yourself with GEE interface if you have done so already.)</li>
<li>In Sampling Design dialog, add the path to the stratification under <em>Specify an image to define study area</em>. The path is likely something like “users/[your name]/stratification_cambodia_utm_small”. Set the band to “1” and mask value to “0” and click <em>Load image</em>.</li>
<li><strong>Sampling scheme.</strong> Because the objective of the exercise is to estimate the area forest loss which is a small part of the study area, the sample will be selected by stratified random sampling – under <em>Select a sampling scheme</em> select <em>Stratified random</em>.</li>
<li><strong>Sample size.</strong> Further, we will <em>Determine sample size</em> by setting a <em>Target SE of a class</em>, in this case, class number 4, Forest loss. The application will print in the Dialog and Console the area proportion of class 4:</li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&gt;&gt;&gt; Area proportion of class 4:
    0.0667431639819303
</pre></div>
</div>
<ol class="arabic simple" start="7">
<li>To determine the sample size, <em>n</em>, we’ll use Equation 5.25 in <a class="footnote-reference" href="#id6" id="id3">[2]</a></li>
</ol>
<div class="math notranslate nohighlight">
\[n = \left(\frac{\sum_{h} W_h \mbox{SD}_h}{\mbox{SE}(\hat{y})}\right )^2\]</div>
<p>where <span class="math notranslate nohighlight">\(W_h\)</span> are the strata weights that are automatically extracted from the stratification; <span class="math notranslate nohighlight">\(\mbox{SD}_h\)</span> are the stratum standard deviations, calculated as <span class="math notranslate nohighlight">\(\mbox{SD}_h= \sqrt{p_h (1-p_h)}\)</span> where <span class="math notranslate nohighlight">\(p_h\)</span> is the anticipated area of Forest loss according to the reference data in stratum <span class="math notranslate nohighlight">\(h\)</span>. For class 4, <span class="math notranslate nohighlight">\(p_h\)</span> simply becomes the anticipated user’s accuracy of the Forest loss class. Let’s assume a user’s accuracy of 0.6; specify “0.6” under <em>Anticipated users accuracy (0-1) for class 4</em>.</p>
<ol class="arabic simple" start="8">
<li>For the other strata, <span class="math notranslate nohighlight">\(p_h\)</span> becomes the anticipated area of Forest loss according to the reference data in stratum <span class="math notranslate nohighlight">\(h\)</span>. Just like the user’s accuracy of Forest loss, these numbers are unknown and we have to make a best guess.  Let’s assume an area proportion of Forest loss  of 0.01 in the region classified as Forest, Non-forest and Water but zero in the other forest change strata: add under <em>Specify anticipated proportion of class 4 in other strata</em> the following <span class="math notranslate nohighlight">\(p_1 = p_2 = p_3 = 0.01\)</span> and <span class="math notranslate nohighlight">\(p_5 = p_6 = 0\)</span>.</li>
<li>The denominator <span class="math notranslate nohighlight">\(\mbox{SE}(\hat{y})\)</span> is the target standard error of the area estimate of forest loss <span class="math notranslate nohighlight">\(\hat{y}\)</span> that we aim to achieve. The target standard error has a substantial impact on the sample size; trying to achieve a small error will result in a larger sample. While the area of forest loss is unknown, we know that the mapped area proportion is 0.066. A target standard error expressed as an area proportion of  0.005 is equivalent of a 95% confidence interval of <span class="math notranslate nohighlight">\(\pm 1.96 \times 0.005 = 0.01\)</span> or a margin of error of <span class="math notranslate nohighlight">\(0.01 \div 0.066 = 15\%\)</span>. Specify 0.005 under <em>Set target SE of the area of class 4</em>; the Dialog should look like this:</li>
</ol>
<a class="reference internal image-reference" href="_images/str_dialog.png"><img alt="_images/str_dialog.png" src="_images/str_dialog.png" style="width: 300pt;" /></a>
<ol class="arabic simple" start="10">
<li><strong>Allocation.</strong> Click <em>Calculate sample size</em>; a sample of 625 units is recommended. The next step is to allocate the sample to strata. To estimate area (or any estimate across strata such as overall and producer’s accuracy as opposed to user’s accuracy), a proportional allocation of the sample to strata is preferable <a class="footnote-reference" href="#id7" id="id4">[3]</a>.  The problem with proportional allocation is that the sample size will be very small in the smaller strata. A proportional allocation would yield 258, 308, 14, 42, 2, 1 sample units respectively. If bumping the sample size in the very small strata to 30, in forest loss stratum from 42 to 50, and keep the sample size at 250 and 300 in the forest and non-forest stratum, we get the following allocation – specify under <em>Allocate sample to strata</em> the following and click <em>Create sample</em>:</li>
</ol>
<blockquote>
<div><ol class="arabic simple">
<li>Forest: 250</li>
<li>Non-forest: 300</li>
<li>Water: 30</li>
<li>Forest loss: 50</li>
<li>Forest gain: 30</li>
<li>Forest gain/loss: 30</li>
</ol>
</div></blockquote>
<ol class="arabic simple" start="11">
<li><strong>Export sample.</strong> Clicking <em>Add to map</em> will display the sample units as red dots in the Map display. The final step is to export the sample: click the Tasks tab, and then <em>Export sample</em> in the Dialog – two entries named “sample” will appear in Tasks. These are identical but one is of exporting the sample as a CSV file and one as a GEE Asset file for use in Google Earth Engine. Click the <em>Run</em> button right next one of the  “sample” entries and save as an GEE Asset; redo for the other sample entry but save as a CSV file on Google Drive.</li>
</ol>
</div>
<div class="section" id="response-design">
<h2>2. Response Design<a class="headerlink" href="#response-design" title="Permalink to this headline">¶</a></h2>
<p>We now need to provide reference observations for each unit in the sample that we designed in the previous step. Reference data are required for observing reference conditions. A powerful reference dataset is the combination of high resolution imagery and time series. Different  applications have been developed that allow you to display such data at sample locations. In this tutorial we will use an application in the Earth Engine called Time Series Viewer. (Other applications include <a class="reference external" href="https://gee-assessment-tools.readthedocs.io/en/latest/timesync.html">TimeSync</a> and <a class="reference external" href="https://gee-assessment-tools.readthedocs.io/en/latest/coleearth.html">Collect Earth Online</a> .)</p>
<ol class="arabic simple">
<li>To view satellite data at sample locations, first run the script 1_5_save_feature_timeseries – specify the  the GEE Asset Table that contains the sample (i.e. the GEE Asset you created in  Sampling Design, Step 11, above), and click OK. 2. An entry in the Tasks tab will appear called TSData. In the Tasks tab, click Run next to TSData as save as a GEE Asset. This will extract time series data at each location in the sample. It might take a while.</li>
<li>When done, display the script 2_0_Time_Series_Viewer in the Code Editor.</li>
<li>In the Assets tab, click the GEE Asset Table contains the sample (i.e. the GEE Asset you created in Step 2). A dialog box should pop up with the header “Table: [file name]” – click <em>Import</em>.</li>
<li>This will import the sample into 2_Time_Series_Viewer; at the top of the script where is it says “Imports (1 entry)”, change the second line by replacing “table:” with “sample:” such that it looks like in the Figure below.</li>
<li>Click <em>Save</em> and then <em>Run</em> in the Code Editor to run the script 2_0_Time_Series_Viewer.</li>
<li>In the dialog that appears next to the Map pane, check the box <em>Load data from feature collection</em></li>
<li>Click either Next or add “1” as <em>Search ID</em> and hit Enter – the first unit in the sample will appear as a red square in the Map pane and plots of time series  of surface reflectance and spectral transforms based on Landsat data will appear in the Dialog (as shown in Figure 1 below).</li>
<li>Clicking a point in the time series will display the associated Landsat image in the Map pane – use this data to collect reference observations on the land surface. In this example, the response legend corresponds to the map legend – i.e. each sample unit will be labeled either forest, non-forest, water, forest loss, forest gain, and forest gain/loss (the latter being pixels that experienced forest loss but recovered during the study period 2000-2010).</li>
</ol>
<a class="reference internal image-reference" href="_images/response_design.png"><img alt="_images/response_design.png" src="_images/response_design.png" style="width: 600pt;" /></a>
<p>Figure 1. Screen shot of using Time Series Viewer to collect reference observations for sample units.</p>
<ol class="arabic" start="9">
<li><p class="first">To record the reference labels, open the CSV file you created in Sampling Design, Step 11, in Google Sheets. <strong>Delete</strong> columns “classification” and “.geo”.; and <strong>add</strong> columns “reference”, “reference_name”, “date_event”, “confidence” to the right of column “.geo”.</p>
</li>
<li><p class="first">In column “reference”, record the grid code of the reference label (1: forest, 2: non-forest, 3: water, 4: forest loss, 5: forest gain, and 6: forest loss and gain); in column “reference_name”, write the name of the reference label; in “date_event”, note the year of the loss or gain events; in column “confidence”, indicate by how confident you are that the label is correct – specify 1 if label is uncertain, 2 if probable but not certain, and 3 if certain. For example, I am certain that sample unit #7 in Figure 1 above experienced a forest loss event in 2010. I would then add</p>
<blockquote>
<div><p>reference: 1
reference_name: Forest loss
date_event: 2010
confidence: 3</p>
</div></blockquote>
</li>
</ol>
</div>
<div class="section" id="analysis">
<h2>3. Analysis<a class="headerlink" href="#analysis" title="Permalink to this headline">¶</a></h2>
<p>Text</p>
<table class="docutils footnote" frame="void" id="id5" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td>Hansen, M. C., Potapov, P. V., Moore, R., Hancher, M., Turubanova, S. A. A., Tyukavina, A., … &amp; Kommareddy, A. (2013). High-resolution global maps of 21st-century forest cover change. <em>Science</em>, 342(6160), 850-853.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id6" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[2]</a></td><td>Cochran, W. G. (1977). <em>Sampling techniques</em>. John Wiley &amp; Sons.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id7" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id4">[3]</a></td><td>Olofsson, P., Foody, G. M., Herold, M., Stehman, S. V., Woodcock, C. E., &amp; Wulder, M. A. (2014). Good practices for estimating area and assessing accuracy of land change. <em>Remote Sensing of Environment</em>, 148, 42-57.</td></tr>
</tbody>
</table>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="estimator_twostage.html" class="btn btn-neutral" title="Two-stage Estimator ○" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Eric Bullock.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.1',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>